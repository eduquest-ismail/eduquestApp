<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1">
	  <title>Eduquest Mobile</title>
    <link rel="stylesheet" href="themes/iszaTheme.css" />
    <link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
    <link rel="stylesheet" href="themes/jqm-demos.css" />
    <link rel="stylesheet" href="themes/jquery.mobile.structure-1.4.3.min.css" /> 
    <script src="scripts/jquery-1.11.1.min.js"></script> 
    <script src="scripts/jquery.mobile-1.4.3.min.js"></script> 
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">

    document.addEventListener("deviceready", onDeviceReady, false);
  
    function onDeviceReady() {
      var x = window.localStorage.getItem("uid");
      var y = window.localStorage.getItem("pwd");
       if(x!=null && y!=null)
       {
         verifyLogin(x,y);
       }
       else
       {
         clearPwd();
       }
    }
    function verifyLogin(u,p)
    {
        var xmlhttp;
        if (window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () 
        {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
            {
                if(xmlhttp.responseText=="true")
                {
                  startApp();
                }
                else
                {
                  clearPwd();
                }
            }
        }
        xmlhttp.open("POST", "http://m.eduquest.com.sg/verifyLogin.aspx?u=" + u + "&p=" + p, true);
        xmlhttp.send();
    }
    function startApp()
    {
      window.open('http://m.eduquest.com.sg', '_self', 'location=yes');
    }
    function clearPwd()
    {
      window.localStorage.clear();
      document.getElementById('loginPanel').style.display = 'block';
    }
    function validateForm() {
      var x = document.forms["myForm"]["UID"].value;
      if (x == null || x == "") {
          alert("Username cannot Blank");
          return false;
      }
      var y = document.forms["myForm"]["PWD"].value;
      if (y == null || y == "") {
          alert("Password cannot Blank");
          return false;
      }
      window.localStorage.setItem("uid", x);
      window.localStorage.setItem("pwd", y);
    }
    </script>
    <style>
      .bg
      {
          background: rgba(255,203,140,1);
          background: -moz-radial-gradient(center, ellipse cover, rgba(255,203,140,1) 0%, rgba(255,146,10,1) 100%);
          background: -webkit-gradient(radial, center center, 0px, center center, 100%, , color-stop(0%, rgba(255,203,140,1)), color-stop(100%, rgba(255,146,10,1)));
          background: -webkit-radial-gradient(center, ellipse cover, rgba(255,203,140,1) 0%, rgba(255,146,10,1) 100%);
          background: -o-radial-gradient(center, ellipse cover, rgba(255,203,140,1) 0%, rgba(255,146,10,1) 100%);
          background: -ms-radial-gradient(center, ellipse cover, rgba(255,203,140,1) 0%, rgba(255,146,10,1) 100%);
          background: radial-gradient(ellipse at center, rgba(255,203,140,1) 0%, rgba(255,146,10,1) 100%);
          filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffcb8c', endColorstr='#ff920a', GradientType=1 );
      }
    </style>
  </head>
  <body>
    <div data-role="page" class="bg jqm-demos jqm-home ui-page-theme-a">
        <div style="margin:25px 0 0 0;">
        <center>
            <img src="images\eduquest.png" />     
        </center>
        </div>
        <div id="loginPanel" style="margin:20px;display:none;" >            
          <form name="myForm" onsubmit="return validateForm()">
            <ul data-role="listview" data-inset="true">  
                 <li class="ui-field-contain">
                    <label for="UID">User Name</label>
                    <input type="text" name="UID" id="UID" value="" data-clear-btn="true">
                </li>
                 <li class="ui-field-contain">
                    <label for="PWD">Password</label>
                    <input type="password" name="PWD" id="PWD" value="" data-clear-btn="true">
                </li>
                 <li class="ui-field-contain">
                    <input type="submit" value="LOGIN" style="float:right;"> 
                    <button type="button" onclick="startApp()" style="float:right;">SKIP</button>          
                </li> 
            </ul>   
          </form>
        </div>
    </div>
  </body>
</html>
